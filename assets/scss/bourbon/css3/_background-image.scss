@use "sass:list";
@use "sass:map";
@use "sass:meta";
@use "sass:string";
@use "../helpers/linear-gradient-parser";
@use "../helpers/radial-gradient-parser";

//************************************************************************//
// Background-image property for adding multiple background images with
// gradients, or for stringing multiple gradients together.
//************************************************************************//

@mixin background-image($images...) {
  $webkit-images: ();
  $spec-images: ();

  @each $image in $images {
    $webkit-image: ();
    $spec-image: ();

    @if (meta.type-of($image) == string) {
      $url-str:       string.slice($image, 1, 3);
      $gradient-type: string.slice($image, 1, 6);

      @if $url-str == "url" {
        $webkit-image: $image;
        $spec-image:   $image;
      }

      @else if $gradient-type == "linear" {
        $gradients: linear-gradient-parser.linear-gradient-parser($image);
        $webkit-image:  map.get($gradients, webkit-image);
        $spec-image:    map.get($gradients, spec-image);
      }

      @else if $gradient-type == "radial" {
        $gradients: radial-gradient-parser.radial-gradient-parser($image);
        $webkit-image: map.get($gradients, webkit-image);
        $spec-image:   map.get($gradients, spec-image);
      }
    }

    $webkit-images: list.append($webkit-images, $webkit-image, comma);
    $spec-images:   list.append($spec-images,   $spec-image,   comma);
  }

  background-image: $webkit-images;
  background-image: $spec-images;
}
